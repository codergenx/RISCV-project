.data
# Precomputed sine and cosine tables (for 1024-point FFT)
twiddle_real:  # Real parts (cosine)
    .float 1.00000000, 0.99998118, 0.99992470, 0.99983058, 0.99969882, 0.99952942, 0.99932238, 0.99907773
    .float 0.99879546, 0.99847558, 0.99811811, 0.99772307, 0.99729046, 0.99682030, 0.99631261, 0.99576741
    .float 0.99518473, 0.99456457, 0.99390697, 0.99321195, 0.99247953, 0.99170975, 0.99090264, 0.99005821
    .float 0.98917651, 0.98825757, 0.98730142, 0.98630810, 0.98527764, 0.98421009, 0.98310549, 0.98196387
    .float 0.98078528, 0.97956977, 0.97831737, 0.97702814, 0.97570213, 0.97433938, 0.97293995, 0.97150389
    .float 0.97003125, 0.96852209, 0.96697647, 0.96539444, 0.96377607, 0.96212140, 0.96043052, 0.95870347
    .float 0.95694034, 0.95514117, 0.95330604, 0.95143502, 0.94952818, 0.94758559, 0.94560733, 0.94359346
    .float 0.94154407, 0.93945922, 0.93733901, 0.93518351, 0.93299280, 0.93076696, 0.92850608, 0.92621024
    .float 0.92387953, 0.92151404, 0.91911385, 0.91667906, 0.91420976, 0.91170603, 0.90916798, 0.90659570
    .float 0.90398929, 0.90134885, 0.89867447, 0.89596625, 0.89322430, 0.89044872, 0.88763962, 0.88479710
    .float 0.88192126, 0.87901223, 0.87607009, 0.87309498, 0.87008699, 0.86704625, 0.86397286, 0.86086694
    .float 0.85772861, 0.85455799, 0.85135519, 0.84812034, 0.84485357, 0.84155498, 0.83822471, 0.83486287
    .float 0.83146961, 0.82804505, 0.82458930, 0.82110251, 0.81758481, 0.81403633, 0.81045720, 0.80684755
    .float 0.80320753, 0.79953727, 0.79583690, 0.79210658, 0.78834643, 0.78455660, 0.78073723, 0.77688847
    .float 0.77301045, 0.76910334, 0.76516727, 0.76120239, 0.75720885, 0.75318680, 0.74913639, 0.74505779
    .float 0.74095113, 0.73681657, 0.73265427, 0.72846439, 0.72424708, 0.72000251, 0.71573083, 0.71143220
    .float 0.70710678, 0.70275474, 0.69837625, 0.69397146, 0.68954054, 0.68508367, 0.68060100, 0.67609270
    .float 0.67155895, 0.66699992, 0.66241578, 0.65780669, 0.65317284, 0.64851440, 0.64383154, 0.63912444
    .float 0.63439328, 0.62963824, 0.62485949, 0.62005721, 0.61523159, 0.61038281, 0.60551104, 0.60061648
    .float 0.59569930, 0.59075970, 0.58579786, 0.58081396, 0.57580819, 0.57078075, 0.56573181, 0.56066158
    .float 0.55557023, 0.55045797, 0.54532499, 0.54017147, 0.53499762, 0.52980362, 0.52458968, 0.51935599
    .float 0.51410274, 0.50883014, 0.50353838, 0.49822767, 0.49289819, 0.48755016, 0.48218377, 0.47679923
    .float 0.47139674, 0.46597650, 0.46053871, 0.45508359, 0.44961133, 0.44412214, 0.43861624, 0.43309382
    .float 0.42755509, 0.42200027, 0.41642956, 0.41084317, 0.40524131, 0.39962420, 0.39399204, 0.38834505
    .float 0.38268343, 0.37700741, 0.37131719, 0.36561300, 0.35989504, 0.35416353, 0.34841868, 0.34266072
    .float 0.33688985, 0.33110631, 0.32531029, 0.31950203, 0.31368174, 0.30784964, 0.30200595, 0.29615089
    .float 0.29028468, 0.28440754, 0.27851969, 0.27262136, 0.26671276, 0.26079412, 0.25486566, 0.24892761
    .float 0.24298018, 0.23702361, 0.23105811, 0.22508391, 0.21910124, 0.21311032, 0.20711138, 0.20110463
    .float 0.19509032, 0.18906866, 0.18303989, 0.17700422, 0.17096189, 0.16491312, 0.15885814, 0.15279719
    .float 0.14673047, 0.14065824, 0.13458071, 0.12849811, 0.12241068, 0.11631863, 0.11022221, 0.10412163
    .float 0.09801714, 0.09190896, 0.08579731, 0.07968244, 0.07356456, 0.06744392, 0.06132074, 0.05519524
    .float 0.04906767, 0.04293826, 0.03680722, 0.03067480, 0.02454123, 0.01840673, 0.01227154, 0.00613588
    .float 0.00000000, -0.00613588, -0.01227154, -0.01840673, -0.02454123, -0.03067480, -0.03680722, -0.04293826
    .float -0.04906767, -0.05519524, -0.06132074, -0.06744392, -0.07356456, -0.07968244, -0.08579731, -0.09190896
    .float -0.09801714, -0.10412163, -0.11022221, -0.11631863, -0.12241068, -0.12849811, -0.13458071, -0.14065824
    .float -0.14673047, -0.15279719, -0.15885814, -0.16491312, -0.17096189, -0.17700422, -0.18303989, -0.18906866
    .float -0.19509032, -0.20110463, -0.20711138, -0.21311032, -0.21910124, -0.22508391, -0.23105811, -0.23702361
    .float -0.24298018, -0.24892761, -0.25486566, -0.26079412, -0.26671276, -0.27262136, -0.27851969, -0.28440754
    .float -0.29028468, -0.29615089, -0.30200595, -0.30784964, -0.31368174, -0.31950203, -0.32531029, -0.33110631
    .float -0.33688985, -0.34266072, -0.34841868, -0.35416353, -0.35989504, -0.36561300, -0.37131719, -0.37700741
    .float -0.38268343, -0.38834505, -0.39399204, -0.39962420, -0.40524131, -0.41084317, -0.41642956, -0.42200027
    .float -0.42755509, -0.43309382, -0.43861624, -0.44412214, -0.44961133, -0.45508359, -0.46053871, -0.46597650
    .float -0.47139674, -0.47679923, -0.48218377, -0.48755016, -0.49289819, -0.49822767, -0.50353838, -0.50883014
    .float -0.51410274, -0.51935599, -0.52458968, -0.52980362, -0.53499762, -0.54017147, -0.54532499, -0.55045797
    .float -0.55557023, -0.56066158, -0.56573181, -0.57078075, -0.57580819, -0.58081396, -0.58579786, -0.59075970
    .float -0.59569930, -0.60061648, -0.60551104, -0.61038281, -0.61523159, -0.62005721, -0.62485949, -0.62963824
    .float -0.63439328, -0.63912444, -0.64383154, -0.64851440, -0.65317284, -0.65780669, -0.66241578, -0.66699992
    .float -0.67155895, -0.67609270, -0.68060100, -0.68508367, -0.68954054, -0.69397146, -0.69837625, -0.70275474
    .float -0.70710678, -0.71143220, -0.71573083, -0.72000251, -0.72424708, -0.72846439, -0.73265427, -0.73681657
    .float -0.74095113, -0.74505779, -0.74913639, -0.75318680, -0.75720885, -0.76120239, -0.76516727, -0.76910334
    .float -0.77301045, -0.77688847, -0.78073723, -0.78455660, -0.78834643, -0.79210658, -0.79583690, -0.79953727
    .float -0.80320753, -0.80684755, -0.81045720, -0.81403633, -0.81758481, -0.82110251, -0.82458930, -0.82804505
    .float -0.83146961, -0.83486287, -0.83822471, -0.84155498, -0.84485357, -0.84812034, -0.85135519, -0.85455799
    .float -0.85772861, -0.86086694, -0.86397286, -0.86704625, -0.87008699, -0.87309498, -0.87607009, -0.87901223
    .float -0.88192126, -0.88479710, -0.88763962, -0.89044872, -0.89322430, -0.89596625, -0.89867447, -0.90134885
    .float -0.90398929, -0.90659570, -0.90916798, -0.91170603, -0.91420976, -0.91667906, -0.91911385, -0.92151404
    .float -0.92387953, -0.92621024, -0.92850608, -0.93076696, -0.93299280, -0.93518351, -0.93733901, -0.93945922
    .float -0.94154407, -0.94359346, -0.94560733, -0.94758559, -0.94952818, -0.95143502, -0.95330604, -0.95514117
    .float -0.95694034, -0.95870347, -0.96043052, -0.96212140, -0.96377607, -0.96539444, -0.96697647, -0.96852209
    .float -0.97003125, -0.97150389, -0.97293995, -0.97433938, -0.97570213, -0.97702814, -0.97831737, -0.97956977
    .float -0.98078528, -0.98196387, -0.98310549, -0.98421009, -0.98527764, -0.98630810, -0.98730142, -0.98825757
    .float -0.98917651, -0.99005821, -0.99090264, -0.99170975, -0.99247953, -0.99321195, -0.99390697, -0.99456457
    .float -0.99518473, -0.99576741, -0.99631261, -0.99682030, -0.99729046, -0.99772307, -0.99811811, -0.99847558
    .float -0.99879546, -0.99907773, -0.99932238, -0.99952942, -0.99969882, -0.99983058, -0.99992470, -0.99998118
    .float -1.00000000, -0.99998118, -0.99992470, -0.99983058, -0.99969882, -0.99952942, -0.99932238, -0.99907773
    .float -0.99879546, -0.99847558, -0.99811811, -0.99772307, -0.99729046, -0.99682030, -0.99631261, -0.99576741
    .float -0.99518473, -0.99456457, -0.99390697, -0.99321195, -0.99247953, -0.99170975, -0.99090264, -0.99005821
    .float -0.98917651, -0.98825757, -0.98730142, -0.98630810, -0.98527764, -0.98421009, -0.98310549, -0.98196387
    .float -0.98078528, -0.97956977, -0.97831737, -0.97702814, -0.97570213, -0.97433938, -0.97293995, -0.97150389
    .float -0.97003125, -0.96852209, -0.96697647, -0.96539444, -0.96377607, -0.96212140, -0.96043052, -0.95870347
    .float -0.95694034, -0.95514117, -0.95330604, -0.95143502, -0.94952818, -0.94758559, -0.94560733, -0.94359346
    .float -0.94154407, -0.93945922, -0.93733901, -0.93518351, -0.93299280, -0.93076696, -0.92850608, -0.92621024
    .float -0.92387953, -0.92151404, -0.91911385, -0.91667906, -0.91420976, -0.91170603, -0.90916798, -0.90659570
    .float -0.90398929, -0.90134885, -0.89867447, -0.89596625, -0.89322430, -0.89044872, -0.88763962, -0.88479710
    .float -0.88192126, -0.87901223, -0.87607009, -0.87309498, -0.87008699, -0.86704625, -0.86397286, -0.86086694
    .float -0.85772861, -0.85455799, -0.85135519, -0.84812034, -0.84485357, -0.84155498, -0.83822471, -0.83486287
    .float -0.83146961, -0.82804505, -0.82458930, -0.82110251, -0.81758481, -0.81403633, -0.81045720, -0.80684755
    .float -0.80320753, -0.79953727, -0.79583690, -0.79210658, -0.78834643, -0.78455660, -0.78073723, -0.77688847
    .float -0.77301045, -0.76910334, -0.76516727, -0.76120239, -0.75720885, -0.75318680, -0.74913639, -0.74505779
    .float -0.74095113, -0.73681657, -0.73265427, -0.72846439, -0.72424708, -0.72000251, -0.71573083, -0.71143220
    .float -0.70710678, -0.70275474, -0.69837625, -0.69397146, -0.68954054, -0.68508367, -0.68060100, -0.67609270
    .float -0.67155895, -0.66699992, -0.66241578, -0.65780669, -0.65317284, -0.64851440, -0.64383154, -0.63912444
    .float -0.63439328, -0.62963824, -0.62485949, -0.62005721, -0.61523159, -0.61038281, -0.60551104, -0.60061648
    .float -0.59569930, -0.59075970, -0.58579786, -0.58081396, -0.57580819, -0.57078075, -0.56573181, -0.56066158
    .float -0.55557023, -0.55045797, -0.54532499, -0.54017147, -0.53499762, -0.52980362, -0.52458968, -0.51935599
    .float -0.51410274, -0.50883014, -0.50353838, -0.49822767, -0.49289819, -0.48755016, -0.48218377, -0.47679923
    .float -0.47139674, -0.46597650, -0.46053871, -0.45508359, -0.44961133, -0.44412214, -0.43861624, -0.43309382
    .float -0.42755509, -0.42200027, -0.41642956, -0.41084317, -0.40524131, -0.39962420, -0.39399204, -0.38834505
    .float -0.38268343, -0.37700741, -0.37131719, -0.36561300, -0.35989504, -0.35416353, -0.34841868, -0.34266072
    .float -0.33688985, -0.33110631, -0.32531029, -0.31950203, -0.31368174, -0.30784964, -0.30200595, -0.29615089
    .float -0.29028468, -0.28440754, -0.27851969, -0.27262136, -0.26671276, -0.26079412, -0.25486566, -0.24892761
    .float -0.24298018, -0.23702361, -0.23105811, -0.22508391, -0.21910124, -0.21311032, -0.20711138, -0.20110463
    .float -0.19509032, -0.18906866, -0.18303989, -0.17700422, -0.17096189, -0.16491312, -0.15885814, -0.15279719
    .float -0.14673047, -0.14065824, -0.13458071, -0.12849811, -0.12241068, -0.11631863, -0.11022221, -0.10412163
    .float -0.09801714, -0.09190896, -0.08579731, -0.07968244, -0.07356456, -0.06744392, -0.06132074, -0.05519524
    .float -0.04906767, -0.04293826, -0.03680722, -0.03067480, -0.02454123, -0.01840673, -0.01227154, -0.00613588
    .float -0.00000000, 0.00613588, 0.01227154, 0.01840673, 0.02454123, 0.03067480, 0.03680722, 0.04293826
    .float 0.04906767, 0.05519524, 0.06132074, 0.06744392, 0.07356456, 0.07968244, 0.08579731, 0.09190896
    .float 0.09801714, 0.10412163, 0.11022221, 0.11631863, 0.12241068, 0.12849811, 0.13458071, 0.14065824
    .float 0.14673047, 0.15279719, 0.15885814, 0.16491312, 0.17096189, 0.17700422, 0.18303989, 0.18906866
    .float 0.19509032, 0.20110463, 0.20711138, 0.21311032, 0.21910124, 0.22508391, 0.23105811, 0.23702361
    .float 0.24298018, 0.24892761, 0.25486566, 0.26079412, 0.26671276, 0.27262136, 0.27851969, 0.28440754
    .float 0.29028468, 0.29615089, 0.30200595, 0.30784964, 0.31368174, 0.31950203, 0.32531029, 0.33110631
    .float 0.33688985, 0.34266072, 0.34841868, 0.35416353, 0.35989504, 0.36561300, 0.37131719, 0.37700741
    .float 0.38268343, 0.38834505, 0.39399204, 0.39962420, 0.40524131, 0.41084317, 0.41642956, 0.42200027
    .float 0.42755509, 0.43309382, 0.43861624, 0.44412214, 0.44961133, 0.45508359, 0.46053871, 0.46597650
    .float 0.47139674, 0.47679923, 0.48218377, 0.48755016, 0.49289819, 0.49822767, 0.50353838, 0.50883014
    .float 0.51410274, 0.51935599, 0.52458968, 0.52980362, 0.53499762, 0.54017147, 0.54532499, 0.55045797
    .float 0.55557023, 0.56066158, 0.56573181, 0.57078075, 0.57580819, 0.58081396, 0.58579786, 0.59075970
    .float 0.59569930, 0.60061648, 0.60551104, 0.61038281, 0.61523159, 0.62005721, 0.62485949, 0.62963824
    .float 0.63439328, 0.63912444, 0.64383154, 0.64851440, 0.65317284, 0.65780669, 0.66241578, 0.66699992
    .float 0.67155895, 0.67609270, 0.68060100, 0.68508367, 0.68954054, 0.69397146, 0.69837625, 0.70275474
    .float 0.70710678, 0.71143220, 0.71573083, 0.72000251, 0.72424708, 0.72846439, 0.73265427, 0.73681657
    .float 0.74095113, 0.74505779, 0.74913639, 0.75318680, 0.75720885, 0.76120239, 0.76516727, 0.76910334
    .float 0.77301045, 0.77688847, 0.78073723, 0.78455660, 0.78834643, 0.79210658, 0.79583690, 0.79953727
    .float 0.80320753, 0.80684755, 0.81045720, 0.81403633, 0.81758481, 0.82110251, 0.82458930, 0.82804505
    .float 0.83146961, 0.83486287, 0.83822471, 0.84155498, 0.84485357, 0.84812034, 0.85135519, 0.85455799
    .float 0.85772861, 0.86086694, 0.86397286, 0.86704625, 0.87008699, 0.87309498, 0.87607009, 0.87901223
    .float 0.88192126, 0.88479710, 0.88763962, 0.89044872, 0.89322430, 0.89596625, 0.89867447, 0.90134885
    .float 0.90398929, 0.90659570, 0.90916798, 0.91170603, 0.91420976, 0.91667906, 0.91911385, 0.92151404
    .float 0.92387953, 0.92621024, 0.92850608, 0.93076696, 0.93299280, 0.93518351, 0.93733901, 0.93945922
    .float 0.94154407, 0.94359346, 0.94560733, 0.94758559, 0.94952818, 0.95143502, 0.95330604, 0.95514117
    .float 0.95694034, 0.95870347, 0.96043052, 0.96212140, 0.96377607, 0.96539444, 0.96697647, 0.96852209
    .float 0.97003125, 0.97150389, 0.97293995, 0.97433938, 0.97570213, 0.97702814, 0.97831737, 0.97956977
    .float 0.98078528, 0.98196387, 0.98310549, 0.98421009, 0.98527764, 0.98630810, 0.98730142, 0.98825757
    .float 0.98917651, 0.99005821, 0.99090264, 0.99170975, 0.99247953, 0.99321195, 0.99390697, 0.99456457
    .float 0.99518473, 0.99576741, 0.99631261, 0.99682030, 0.99729046, 0.99772307, 0.99811811, 0.99847558
    .float 0.99879546, 0.99907773, 0.99932238, 0.99952942, 0.99969882, 0.99983058, 0.99992470, 0.99998118
twiddle_imag:  # Imaginary parts (sine)
    .float 0.00000000, 0.00613588, 0.01227154, 0.01840673, 0.02454123, 0.03067480, 0.03680722, 0.04293826
    .float 0.04906767, 0.05519524, 0.06132074, 0.06744392, 0.07356456, 0.07968244, 0.08579731, 0.09190896
    .float 0.09801714, 0.10412163, 0.11022221, 0.11631863, 0.12241068, 0.12849811, 0.13458071, 0.14065824
    .float 0.14673047, 0.15279719, 0.15885814, 0.16491312, 0.17096189, 0.17700422, 0.18303989, 0.18906866
    .float 0.19509032, 0.20110463, 0.20711138, 0.21311032, 0.21910124, 0.22508391, 0.23105811, 0.23702361
    .float 0.24298018, 0.24892761, 0.25486566, 0.26079412, 0.26671276, 0.27262136, 0.27851969, 0.28440754
    .float 0.29028468, 0.29615089, 0.30200595, 0.30784964, 0.31368174, 0.31950203, 0.32531029, 0.33110631
    .float 0.33688985, 0.34266072, 0.34841868, 0.35416353, 0.35989504, 0.36561300, 0.37131719, 0.37700741
    .float 0.38268343, 0.38834505, 0.39399204, 0.39962420, 0.40524131, 0.41084317, 0.41642956, 0.42200027
    .float 0.42755509, 0.43309382, 0.43861624, 0.44412214, 0.44961133, 0.45508359, 0.46053871, 0.46597650
    .float 0.47139674, 0.47679923, 0.48218377, 0.48755016, 0.49289819, 0.49822767, 0.50353838, 0.50883014
    .float 0.51410274, 0.51935599, 0.52458968, 0.52980362, 0.53499762, 0.54017147, 0.54532499, 0.55045797
    .float 0.55557023, 0.56066158, 0.56573181, 0.57078075, 0.57580819, 0.58081396, 0.58579786, 0.59075970
    .float 0.59569930, 0.60061648, 0.60551104, 0.61038281, 0.61523159, 0.62005721, 0.62485949, 0.62963824
    .float 0.63439328, 0.63912444, 0.64383154, 0.64851440, 0.65317284, 0.65780669, 0.66241578, 0.66699992
    .float 0.67155895, 0.67609270, 0.68060100, 0.68508367, 0.68954054, 0.69397146, 0.69837625, 0.70275474
    .float 0.70710678, 0.71143220, 0.71573083, 0.72000251, 0.72424708, 0.72846439, 0.73265427, 0.73681657
    .float 0.74095113, 0.74505779, 0.74913639, 0.75318680, 0.75720885, 0.76120239, 0.76516727, 0.76910334
    .float 0.77301045, 0.77688847, 0.78073723, 0.78455660, 0.78834643, 0.79210658, 0.79583690, 0.79953727
    .float 0.80320753, 0.80684755, 0.81045720, 0.81403633, 0.81758481, 0.82110251, 0.82458930, 0.82804505
    .float 0.83146961, 0.83486287, 0.83822471, 0.84155498, 0.84485357, 0.84812034, 0.85135519, 0.85455799
    .float 0.85772861, 0.86086694, 0.86397286, 0.86704625, 0.87008699, 0.87309498, 0.87607009, 0.87901223
    .float 0.88192126, 0.88479710, 0.88763962, 0.89044872, 0.89322430, 0.89596625, 0.89867447, 0.90134885
    .float 0.90398929, 0.90659570, 0.90916798, 0.91170603, 0.91420976, 0.91667906, 0.91911385, 0.92151404
    .float 0.92387953, 0.92621024, 0.92850608, 0.93076696, 0.93299280, 0.93518351, 0.93733901, 0.93945922
    .float 0.94154407, 0.94359346, 0.94560733, 0.94758559, 0.94952818, 0.95143502, 0.95330604, 0.95514117
    .float 0.95694034, 0.95870347, 0.96043052, 0.96212140, 0.96377607, 0.96539444, 0.96697647, 0.96852209
    .float 0.97003125, 0.97150389, 0.97293995, 0.97433938, 0.97570213, 0.97702814, 0.97831737, 0.97956977
    .float 0.98078528, 0.98196387, 0.98310549, 0.98421009, 0.98527764, 0.98630810, 0.98730142, 0.98825757
    .float 0.98917651, 0.99005821, 0.99090264, 0.99170975, 0.99247953, 0.99321195, 0.99390697, 0.99456457
    .float 0.99518473, 0.99576741, 0.99631261, 0.99682030, 0.99729046, 0.99772307, 0.99811811, 0.99847558
    .float 0.99879546, 0.99907773, 0.99932238, 0.99952942, 0.99969882, 0.99983058, 0.99992470, 0.99998118
    .float 1.00000000, 0.99998118, 0.99992470, 0.99983058, 0.99969882, 0.99952942, 0.99932238, 0.99907773
    .float 0.99879546, 0.99847558, 0.99811811, 0.99772307, 0.99729046, 0.99682030, 0.99631261, 0.99576741
    .float 0.99518473, 0.99456457, 0.99390697, 0.99321195, 0.99247953, 0.99170975, 0.99090264, 0.99005821
    .float 0.98917651, 0.98825757, 0.98730142, 0.98630810, 0.98527764, 0.98421009, 0.98310549, 0.98196387
    .float 0.98078528, 0.97956977, 0.97831737, 0.97702814, 0.97570213, 0.97433938, 0.97293995, 0.97150389
    .float 0.97003125, 0.96852209, 0.96697647, 0.96539444, 0.96377607, 0.96212140, 0.96043052, 0.95870347
    .float 0.95694034, 0.95514117, 0.95330604, 0.95143502, 0.94952818, 0.94758559, 0.94560733, 0.94359346
    .float 0.94154407, 0.93945922, 0.93733901, 0.93518351, 0.93299280, 0.93076696, 0.92850608, 0.92621024
    .float 0.92387953, 0.92151404, 0.91911385, 0.91667906, 0.91420976, 0.91170603, 0.90916798, 0.90659570
    .float 0.90398929, 0.90134885, 0.89867447, 0.89596625, 0.89322430, 0.89044872, 0.88763962, 0.88479710
    .float 0.88192126, 0.87901223, 0.87607009, 0.87309498, 0.87008699, 0.86704625, 0.86397286, 0.86086694
    .float 0.85772861, 0.85455799, 0.85135519, 0.84812034, 0.84485357, 0.84155498, 0.83822471, 0.83486287
    .float 0.83146961, 0.82804505, 0.82458930, 0.82110251, 0.81758481, 0.81403633, 0.81045720, 0.80684755
    .float 0.80320753, 0.79953727, 0.79583690, 0.79210658, 0.78834643, 0.78455660, 0.78073723, 0.77688847
    .float 0.77301045, 0.76910334, 0.76516727, 0.76120239, 0.75720885, 0.75318680, 0.74913639, 0.74505779
    .float 0.74095113, 0.73681657, 0.73265427, 0.72846439, 0.72424708, 0.72000251, 0.71573083, 0.71143220
    .float 0.70710678, 0.70275474, 0.69837625, 0.69397146, 0.68954054, 0.68508367, 0.68060100, 0.67609270
    .float 0.67155895, 0.66699992, 0.66241578, 0.65780669, 0.65317284, 0.64851440, 0.64383154, 0.63912444
    .float 0.63439328, 0.62963824, 0.62485949, 0.62005721, 0.61523159, 0.61038281, 0.60551104, 0.60061648
    .float 0.59569930, 0.59075970, 0.58579786, 0.58081396, 0.57580819, 0.57078075, 0.56573181, 0.56066158
    .float 0.55557023, 0.55045797, 0.54532499, 0.54017147, 0.53499762, 0.52980362, 0.52458968, 0.51935599
    .float 0.51410274, 0.50883014, 0.50353838, 0.49822767, 0.49289819, 0.48755016, 0.48218377, 0.47679923
    .float 0.47139674, 0.46597650, 0.46053871, 0.45508359, 0.44961133, 0.44412214, 0.43861624, 0.43309382
    .float 0.42755509, 0.42200027, 0.41642956, 0.41084317, 0.40524131, 0.39962420, 0.39399204, 0.38834505
    .float 0.38268343, 0.37700741, 0.37131719, 0.36561300, 0.35989504, 0.35416353, 0.34841868, 0.34266072
    .float 0.33688985, 0.33110631, 0.32531029, 0.31950203, 0.31368174, 0.30784964, 0.30200595, 0.29615089
    .float 0.29028468, 0.28440754, 0.27851969, 0.27262136, 0.26671276, 0.26079412, 0.25486566, 0.24892761
    .float 0.24298018, 0.23702361, 0.23105811, 0.22508391, 0.21910124, 0.21311032, 0.20711138, 0.20110463
    .float 0.19509032, 0.18906866, 0.18303989, 0.17700422, 0.17096189, 0.16491312, 0.15885814, 0.15279719
    .float 0.14673047, 0.14065824, 0.13458071, 0.12849811, 0.12241068, 0.11631863, 0.11022221, 0.10412163
    .float 0.09801714, 0.09190896, 0.08579731, 0.07968244, 0.07356456, 0.06744392, 0.06132074, 0.05519524
    .float 0.04906767, 0.04293826, 0.03680722, 0.03067480, 0.02454123, 0.01840673, 0.01227154, 0.00613588
    .float 0.00000000, -0.00613588, -0.01227154, -0.01840673, -0.02454123, -0.03067480, -0.03680722, -0.04293826
    .float -0.04906767, -0.05519524, -0.06132074, -0.06744392, -0.07356456, -0.07968244, -0.08579731, -0.09190896
    .float -0.09801714, -0.10412163, -0.11022221, -0.11631863, -0.12241068, -0.12849811, -0.13458071, -0.14065824
    .float -0.14673047, -0.15279719, -0.15885814, -0.16491312, -0.17096189, -0.17700422, -0.18303989, -0.18906866
    .float -0.19509032, -0.20110463, -0.20711138, -0.21311032, -0.21910124, -0.22508391, -0.23105811, -0.23702361
    .float -0.24298018, -0.24892761, -0.25486566, -0.26079412, -0.26671276, -0.27262136, -0.27851969, -0.28440754
    .float -0.29028468, -0.29615089, -0.30200595, -0.30784964, -0.31368174, -0.31950203, -0.32531029, -0.33110631
    .float -0.33688985, -0.34266072, -0.34841868, -0.35416353, -0.35989504, -0.36561300, -0.37131719, -0.37700741
    .float -0.38268343, -0.38834505, -0.39399204, -0.39962420, -0.40524131, -0.41084317, -0.41642956, -0.42200027
    .float -0.42755509, -0.43309382, -0.43861624, -0.44412214, -0.44961133, -0.45508359, -0.46053871, -0.46597650
    .float -0.47139674, -0.47679923, -0.48218377, -0.48755016, -0.49289819, -0.49822767, -0.50353838, -0.50883014
    .float -0.51410274, -0.51935599, -0.52458968, -0.52980362, -0.53499762, -0.54017147, -0.54532499, -0.55045797
    .float -0.55557023, -0.56066158, -0.56573181, -0.57078075, -0.57580819, -0.58081396, -0.58579786, -0.59075970
    .float -0.59569930, -0.60061648, -0.60551104, -0.61038281, -0.61523159, -0.62005721, -0.62485949, -0.62963824
    .float -0.63439328, -0.63912444, -0.64383154, -0.64851440, -0.65317284, -0.65780669, -0.66241578, -0.66699992
    .float -0.67155895, -0.67609270, -0.68060100, -0.68508367, -0.68954054, -0.69397146, -0.69837625, -0.70275474
    .float -0.70710678, -0.71143220, -0.71573083, -0.72000251, -0.72424708, -0.72846439, -0.73265427, -0.73681657
    .float -0.74095113, -0.74505779, -0.74913639, -0.75318680, -0.75720885, -0.76120239, -0.76516727, -0.76910334
    .float -0.77301045, -0.77688847, -0.78073723, -0.78455660, -0.78834643, -0.79210658, -0.79583690, -0.79953727
    .float -0.80320753, -0.80684755, -0.81045720, -0.81403633, -0.81758481, -0.82110251, -0.82458930, -0.82804505
    .float -0.83146961, -0.83486287, -0.83822471, -0.84155498, -0.84485357, -0.84812034, -0.85135519, -0.85455799
    .float -0.85772861, -0.86086694, -0.86397286, -0.86704625, -0.87008699, -0.87309498, -0.87607009, -0.87901223
    .float -0.88192126, -0.88479710, -0.88763962, -0.89044872, -0.89322430, -0.89596625, -0.89867447, -0.90134885
    .float -0.90398929, -0.90659570, -0.90916798, -0.91170603, -0.91420976, -0.91667906, -0.91911385, -0.92151404
    .float -0.92387953, -0.92621024, -0.92850608, -0.93076696, -0.93299280, -0.93518351, -0.93733901, -0.93945922
    .float -0.94154407, -0.94359346, -0.94560733, -0.94758559, -0.94952818, -0.95143502, -0.95330604, -0.95514117
    .float -0.95694034, -0.95870347, -0.96043052, -0.96212140, -0.96377607, -0.96539444, -0.96697647, -0.96852209
    .float -0.97003125, -0.97150389, -0.97293995, -0.97433938, -0.97570213, -0.97702814, -0.97831737, -0.97956977
    .float -0.98078528, -0.98196387, -0.98310549, -0.98421009, -0.98527764, -0.98630810, -0.98730142, -0.98825757
    .float -0.98917651, -0.99005821, -0.99090264, -0.99170975, -0.99247953, -0.99321195, -0.99390697, -0.99456457
    .float -0.99518473, -0.99576741, -0.99631261, -0.99682030, -0.99729046, -0.99772307, -0.99811811, -0.99847558
    .float -0.99879546, -0.99907773, -0.99932238, -0.99952942, -0.99969882, -0.99983058, -0.99992470, -0.99998118
    .float -1.00000000, -0.99998118, -0.99992470, -0.99983058, -0.99969882, -0.99952942, -0.99932238, -0.99907773
    .float -0.99879546, -0.99847558, -0.99811811, -0.99772307, -0.99729046, -0.99682030, -0.99631261, -0.99576741
    .float -0.99518473, -0.99456457, -0.99390697, -0.99321195, -0.99247953, -0.99170975, -0.99090264, -0.99005821
    .float -0.98917651, -0.98825757, -0.98730142, -0.98630810, -0.98527764, -0.98421009, -0.98310549, -0.98196387
    .float -0.98078528, -0.97956977, -0.97831737, -0.97702814, -0.97570213, -0.97433938, -0.97293995, -0.97150389
    .float -0.97003125, -0.96852209, -0.96697647, -0.96539444, -0.96377607, -0.96212140, -0.96043052, -0.95870347
    .float -0.95694034, -0.95514117, -0.95330604, -0.95143502, -0.94952818, -0.94758559, -0.94560733, -0.94359346
    .float -0.94154407, -0.93945922, -0.93733901, -0.93518351, -0.93299280, -0.93076696, -0.92850608, -0.92621024
    .float -0.92387953, -0.92151404, -0.91911385, -0.91667906, -0.91420976, -0.91170603, -0.90916798, -0.90659570
    .float -0.90398929, -0.90134885, -0.89867447, -0.89596625, -0.89322430, -0.89044872, -0.88763962, -0.88479710
    .float -0.88192126, -0.87901223, -0.87607009, -0.87309498, -0.87008699, -0.86704625, -0.86397286, -0.86086694
    .float -0.85772861, -0.85455799, -0.85135519, -0.84812034, -0.84485357, -0.84155498, -0.83822471, -0.83486287
    .float -0.83146961, -0.82804505, -0.82458930, -0.82110251, -0.81758481, -0.81403633, -0.81045720, -0.80684755
    .float -0.80320753, -0.79953727, -0.79583690, -0.79210658, -0.78834643, -0.78455660, -0.78073723, -0.77688847
    .float -0.77301045, -0.76910334, -0.76516727, -0.76120239, -0.75720885, -0.75318680, -0.74913639, -0.74505779
    .float -0.74095113, -0.73681657, -0.73265427, -0.72846439, -0.72424708, -0.72000251, -0.71573083, -0.71143220
    .float -0.70710678, -0.70275474, -0.69837625, -0.69397146, -0.68954054, -0.68508367, -0.68060100, -0.67609270
    .float -0.67155895, -0.66699992, -0.66241578, -0.65780669, -0.65317284, -0.64851440, -0.64383154, -0.63912444
    .float -0.63439328, -0.62963824, -0.62485949, -0.62005721, -0.61523159, -0.61038281, -0.60551104, -0.60061648
    .float -0.59569930, -0.59075970, -0.58579786, -0.58081396, -0.57580819, -0.57078075, -0.56573181, -0.56066158
    .float -0.55557023, -0.55045797, -0.54532499, -0.54017147, -0.53499762, -0.52980362, -0.52458968, -0.51935599
    .float -0.51410274, -0.50883014, -0.50353838, -0.49822767, -0.49289819, -0.48755016, -0.48218377, -0.47679923
    .float -0.47139674, -0.46597650, -0.46053871, -0.45508359, -0.44961133, -0.44412214, -0.43861624, -0.43309382
    .float -0.42755509, -0.42200027, -0.41642956, -0.41084317, -0.40524131, -0.39962420, -0.39399204, -0.38834505
    .float -0.38268343, -0.37700741, -0.37131719, -0.36561300, -0.35989504, -0.35416353, -0.34841868, -0.34266072
    .float -0.33688985, -0.33110631, -0.32531029, -0.31950203, -0.31368174, -0.30784964, -0.30200595, -0.29615089
    .float -0.29028468, -0.28440754, -0.27851969, -0.27262136, -0.26671276, -0.26079412, -0.25486566, -0.24892761
    .float -0.24298018, -0.23702361, -0.23105811, -0.22508391, -0.21910124, -0.21311032, -0.20711138, -0.20110463
    .float -0.19509032, -0.18906866, -0.18303989, -0.17700422, -0.17096189, -0.16491312, -0.15885814, -0.15279719
    .float -0.14673047, -0.14065824, -0.13458071, -0.12849811, -0.12241068, -0.11631863, -0.11022221, -0.10412163
    .float -0.09801714, -0.09190896, -0.08579731, -0.07968244, -0.07356456, -0.06744392, -0.06132074, -0.05519524
    .float -0.04906767, -0.04293826, -0.03680722, -0.03067480, -0.02454123, -0.01840673, -0.01227154, -0.00613588


# Input signal (example values)
signal:
    .float 0.00000000, 0.07361306, 0.14711805, 0.22040707, 0.29337256, 0.36590751, 0.43790555, 0.50926121
    .float 0.57987003, 0.64962877, 0.71843551, 0.78618989, 0.85279323, 0.91814867, 0.98216137, 1.04473862
    .float 1.10579002, 1.16522759, 1.22296593, 1.27892236, 1.33301704, 1.38517308, 1.43531669, 1.48337728
    .float 1.52928756, 1.57298369, 1.61440529, 1.65349563, 1.69020165, 1.72447406, 1.75626742, 1.78554022

# Output buffer for bit-reversed data
bit_reversed:
    .rept 1024
        .float 0.0
    .endr

# Constants
N: .word 1024    # Signal length
LOG_N: .word 10  # log2(1024)
BYTES_PER_FLOAT: .word 4  # 4 bytes per float

# Print constants - Updated for proper console output
PRINT_INT: .word 1  # System call for printing integer
PRINT_FLOAT: .word 2  # System call for printing float
PRINT_STRING: .word 4  # System call for printing string
NEWLINE: .string "\n"  # Newline string

# Buffer for printing values
print_buffer: .space 20  # Buffer for converting float to string

.text
.globl _start

_start:
    # Initialize registers
    li a0, 0     # Counter
    li a1, 0     # Bit-reversed index
    lw a2, N     # Load N
    lw a3, LOG_N # Load LOG_N
    lw t0, BYTES_PER_FLOAT  # Load bytes per float

    # Load base addresses
    la a4, signal
    la a5, bit_reversed
    la a6, twiddle_real
    la s9, twiddle_imag  # Use s9 instead of a7 for twiddle_imag

# First perform bit-reversal
bit_reversal_loop:
    # Calculate bit-reversed index
    mv t1, a0    # Copy index (use t1 instead of a1)
    li s0, 0     # Clear bit-reversed result
    li s1, 0     # Position counter

    # Reverse bits
    mv s2, a3    # Number of bits to reverse (LOG_N)
bit_reverse:
    srl t2, t1, s2  # Shift right to get the bit we want (use t2 instead of s3)
    andi t2, t2, 1  # Mask to get just that bit
    slli s0, s0, 1  # Shift left to make room
    or s0, s0, t2   # Add to result
    addi s2, s2, -1 # Decrement bit count
    bgez s2, bit_reverse

    # Load value from input
    slli t3, a0, 2  # Multiply index by bytes per float (a0 * 4)
    add t3, t3, a4  # Add base address
    flw fa0, 0(t3)  # Load float

    # Store in bit-reversed position
    slli t3, s0, 2  # Multiply bit-reversed index by bytes per float (s0 * 4)
    add t3, t3, a5  # Add base address
    fsw fa0, 0(t3)  # Store float

    # Increment and check loop
    addi a0, a0, 1
    blt a0, a2, bit_reversal_loop

# Now perform FFT butterfly operations
li s0, 1     # Start with stage 1 (butterflies of length 2)
li s1, 2     # Butterfly length for stage 1

fft_stage_loop:
    li t0, 2
    div t1, a2, s1  # N/len = number of groups
    div t2, s1, t0  # len/2 = butterfly width

    # Process each group
    li s2, 0        # Group counter
group_loop:
    # Calculate start index for this group
    mul t3, s2, s1  # group * len = group start index

    # Process each butterfly in this group
    li s3, 0        # Butterfly counter
butterfly_loop:
    # Calculate indices
    add t4, t3, s3  # index1 = group_start + butterfly_counter
    add t5, t4, t2  # index2 = index1 + len/2

    # Load values from bit_reversed
    slli t6, t4, 2  # Convert to byte offset
    add t6, t6, a5  # Add base address
    flw fa0, 0(t6)  # Load value at index1

    slli t6, t5, 2  # Convert to byte offset
    add t6, t6, a5  # Add base address
    flw fa1, 0(t6)  # Load value at index2

    # Calculate twiddle factor index
    mul t0, s3, a2  # butterfly_counter * N (reusing t0)
    div t0, t0, s1  # (butterfly_counter * N) / len = twiddle index

    # Load twiddle factors
    slli t6, t0, 2  # Convert to byte offset
    add t6, t6, a6  # Add base address
    flw fa2, 0(t6)  # Load cosine value

    # We need to reload twiddle_imag because we're using s9 instead of a7
    slli t6, t0, 2  # Convert to byte offset
    add t6, t6, s9  # Add base address for twiddle_imag
    flw fa3, 0(t6)  # Load sine value

    # Perform butterfly operation
    fmul.s fa4, fa1, fa2  # Real part * cosine
    fmul.s fa5, fa1, fa3  # Real part * sine

    # Calculate results
    fadd.s fa6, fa0, fa4  # First result
    fsub.s fa7, fa0, fa5  # Second result (fixed: using fa5 instead of fa4)

    # Store results back
    slli t6, t4, 2  # Convert to byte offset
    add t6, t6, a5  # Add base address
    fsw fa6, 0(t6)  # Store first result

    slli t6, t5, 2  # Convert to byte offset
    add t6, t6, a5  # Add base address
    fsw fa7, 0(t6)  # Store second result

    # Next butterfly
    addi s3, s3, 1
    blt s3, t2, butterfly_loop

    # Next group
    addi s2, s2, 1
    blt s2, t1, group_loop

    # Next stage
    slli s1, s1, 1  # len *= 2
    addi s0, s0, 1  # stage++
    ble s1, a2, fft_stage_loop

# Print results
la a0, bit_reversed
lw a1, N    # Load N as the size
jal ra, printToLogVectorized

# Exit program
jal ra, _finish

# VeeR-specific printing function
printToLogVectorized:
    addi sp, sp, -4
    sw a0, 0(sp)

    li t0, 0x123                 # Pattern for help in python script
    li t0, 0x456                 # Pattern for help in python script
    mv a1, a1                   # moving size to get it from log

    li t0, 0                        # load i = 0
    printloop:
        li t2, 4
        vsetvli t2, t2, e32, m1, ta, ma    # Set VLEN to 4 elements
        slli t3, t2, 2                     # Compute VLEN * 4 for address increment

        vle32.v v1, (a0)                   # Load 4 elements into v1
        add a0, a0, t3                     # Increment pointer by VLEN * 4
        add t0, t0, t2                     # Increment index

        bge t0, a1, endPrintLoop           # Exit loop if i >= size
        j printloop                        # Jump to start of loop
    endPrintLoop:
    li t0, 0x123                           # Pattern for help in python script
    li t0, 0x456                           # Pattern for help in python script

    lw a0, 0(sp)
    addi sp, sp, 4

    jr ra

# Function: _finish
# VeeR Related function which writes to to_host which stops the simulator
_finish:
    li t0, 0xd0580000
    li t1, 0xff
    sb t1, 0(t0)
    beq x0, x0, _finish

    .rept 100
        nop
    .endr
    ret